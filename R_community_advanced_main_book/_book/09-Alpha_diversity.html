<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Alpha Diversity | R community advanced analysis</title>
  <meta name="description" content="NEOF book for the R community advanced analysis course" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Alpha Diversity | R community advanced analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/NEOF.png" />
  <meta property="og:description" content="NEOF book for the R community advanced analysis course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Alpha Diversity | R community advanced analysis" />
  
  <meta name="twitter:description" content="NEOF book for the R community advanced analysis course" />
  <meta name="twitter:image" content="/figures/NEOF.png" />

<meta name="author" content="Matthew R. Gemmell" />


<meta name="date" content="2024-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="figures/NEOF_favicon.png" type="image/x-icon" />
<link rel="prev" href="08-Iterating_rarefaction.html"/>
<link rel="next" href="10-Beta_diversity.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="www/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://neof.org.uk/" target="blank"><img src="figures/NEOF_bordered_small.png"></a></li>
<li><a>R community analysis</a></li>

<li class="divider"></li>
<li class="part"><span><b>Intro</b></span></li>
<li class="chapter" data-level="1" data-path="01-R_community_advanced_main_book.html"><a href="01-R_community_advanced_main_book.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="01-R_community_advanced_main_book.html"><a href="01-R_community_advanced_main_book.html#table-of-contents"><i class="fa fa-check"></i>Table of contents</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html"><i class="fa fa-check"></i><b>2</b> Dataset &amp; workflow</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html#dataset"><i class="fa fa-check"></i><b>2.1</b> Dataset</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html#sites"><i class="fa fa-check"></i><b>2.1.1</b> Sites</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html#culture-media"><i class="fa fa-check"></i><b>2.1.2</b> Culture media</a></li>
<li class="chapter" data-level="2.1.3" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html#sum_and_qs"><i class="fa fa-check"></i><b>2.1.3</b> Summary &amp; questions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-Dataset_and_workflow.html"><a href="02-Dataset_and_workflow.html#workflow"><i class="fa fa-check"></i><b>2.2</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-R_packages.html"><a href="03-R_packages.html"><i class="fa fa-check"></i><b>3</b> R Packages</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-R_packages.html"><a href="03-R_packages.html#r-packageslibraries"><i class="fa fa-check"></i><b>3.1</b> R packages/libraries</a></li>
<li class="chapter" data-level="3.2" data-path="03-R_packages.html"><a href="03-R_packages.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>3.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="3.3" data-path="03-R_packages.html"><a href="03-R_packages.html#phyloseq"><i class="fa fa-check"></i><b>3.3</b> phyloseq</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Setup.html"><a href="04-Setup.html"><i class="fa fa-check"></i><b>4</b> Set-up</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Setup.html"><a href="04-Setup.html#cluster"><i class="fa fa-check"></i><b>4.1</b> Logon instructions</a></li>
<li class="chapter" data-level="4.2" data-path="04-Setup.html"><a href="04-Setup.html#mamba"><i class="fa fa-check"></i><b>4.2</b> Mamba</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-Jupyter.html"><a href="05-Jupyter.html"><i class="fa fa-check"></i><b>5</b> Jupyter</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Jupyter.html"><a href="05-Jupyter.html#open-jupyter-notebook"><i class="fa fa-check"></i><b>5.1</b> Open Jupyter-notebook</a></li>
<li class="chapter" data-level="5.2" data-path="05-Jupyter.html"><a href="05-Jupyter.html#create-r-notebook"><i class="fa fa-check"></i><b>5.2</b> Create R notebook</a></li>
<li class="chapter" data-level="5.3" data-path="05-Jupyter.html"><a href="05-Jupyter.html#cells-and-code"><i class="fa fa-check"></i><b>5.3</b> Cells and code</a></li>
<li class="chapter" data-level="5.4" data-path="05-Jupyter.html"><a href="05-Jupyter.html#create-new-cells"><i class="fa fa-check"></i><b>5.4</b> Create new cells</a></li>
<li class="chapter" data-level="5.5" data-path="05-Jupyter.html"><a href="05-Jupyter.html#running-code"><i class="fa fa-check"></i><b>5.5</b> Running code</a></li>
<li class="chapter" data-level="5.6" data-path="05-Jupyter.html"><a href="05-Jupyter.html#saving-the-file"><i class="fa fa-check"></i><b>5.6</b> Saving the file</a></li>
<li class="chapter" data-level="5.7" data-path="05-Jupyter.html"><a href="05-Jupyter.html#title-cells-with-markdown"><i class="fa fa-check"></i><b>5.7</b> Title cells with markdown</a></li>
<li class="chapter" data-level="5.8" data-path="05-Jupyter.html"><a href="05-Jupyter.html#close-the-notebook"><i class="fa fa-check"></i><b>5.8</b> Close the notebook</a></li>
<li class="chapter" data-level="5.9" data-path="05-Jupyter.html"><a href="05-Jupyter.html#jup_vid_tut"><i class="fa fa-check"></i><b>5.9</b> Video tutorial</a></li>
</ul></li>
<li class="part"><span><b>Iterative rarefaction</b></span></li>
<li class="chapter" data-level="6" data-path="06-Iterative_rarefaction.html"><a href="06-Iterative_rarefaction.html"><i class="fa fa-check"></i><b>6</b> Iterative rarefaction intro</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-Iterative_rarefaction.html"><a href="06-Iterative_rarefaction.html#should-you-rarefy"><i class="fa fa-check"></i><b>6.1</b> Should you rarefy?</a></li>
<li class="chapter" data-level="6.2" data-path="06-Iterative_rarefaction.html"><a href="06-Iterative_rarefaction.html#using-iterations"><i class="fa fa-check"></i><b>6.2</b> Using iterations</a></li>
<li class="chapter" data-level="6.3" data-path="06-Iterative_rarefaction.html"><a href="06-Iterative_rarefaction.html#section-contents"><i class="fa fa-check"></i><b>6.3</b> Section contents</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html"><i class="fa fa-check"></i><b>7</b> Random seeds</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-seed-notebook"><i class="fa fa-check"></i><b>7.1</b> Random seed notebook</a></li>
<li class="chapter" data-level="7.2" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-sampling"><i class="fa fa-check"></i><b>7.2</b> Random sampling</a></li>
<li class="chapter" data-level="7.3" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#sampling-with-replacement"><i class="fa fa-check"></i><b>7.3</b> Sampling with replacement</a></li>
<li class="chapter" data-level="7.4" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#setting-a-random-seed"><i class="fa fa-check"></i><b>7.4</b> Setting a random seed</a></li>
<li class="chapter" data-level="7.5" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#reset-seed"><i class="fa fa-check"></i><b>7.5</b> Reset seed</a></li>
<li class="chapter" data-level="7.6" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-seed-practice"><i class="fa fa-check"></i><b>7.6</b> Random seed practice</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-seed-question-1"><i class="fa fa-check"></i><b>7.6.1</b> Random seed: Question 1</a></li>
<li class="chapter" data-level="7.6.2" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-seed-question-2"><i class="fa fa-check"></i><b>7.6.2</b> Random seed: Question 2</a></li>
<li class="chapter" data-level="7.6.3" data-path="07-Rarefaction_and_random_seeds.html"><a href="07-Rarefaction_and_random_seeds.html#random-seed-question-3"><i class="fa fa-check"></i><b>7.6.3</b> Random seed: Question 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html"><i class="fa fa-check"></i><b>8</b> Iterating rarefaction</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#iterating-rarefaction-dataset"><i class="fa fa-check"></i><b>8.1</b> Iterating rarefaction dataset</a></li>
<li class="chapter" data-level="8.2" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#iterating-rarefaction-setup"><i class="fa fa-check"></i><b>8.2</b> Iterating rarefaction setup</a></li>
<li class="chapter" data-level="8.3" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#rarefaction-iterations"><i class="fa fa-check"></i><b>8.3</b> Rarefaction iterations</a></li>
<li class="chapter" data-level="8.4" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#rng_vec_creation"><i class="fa fa-check"></i><b>8.4</b> RNG vector creation</a></li>
<li class="chapter" data-level="8.5" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#phyla-relative-abundance"><i class="fa fa-check"></i><b>8.5</b> Phyla relative abundance</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#subset-and-phyla-aggregation"><i class="fa fa-check"></i><b>8.5.1</b> Subset and phyla aggregation</a></li>
<li class="chapter" data-level="8.5.2" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#phyla-relative-abundance-bar-chart"><i class="fa fa-check"></i><b>8.5.2</b> Phyla relative abundance bar chart</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#one-round-1r-of-rarefaction"><i class="fa fa-check"></i><b>8.6</b> One Round (1R) of rarefaction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#r-rarefaction"><i class="fa fa-check"></i><b>8.6.1</b> 1R: Rarefaction</a></li>
<li class="chapter" data-level="8.6.2" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#r-relative-abundance-bar-chart"><i class="fa fa-check"></i><b>8.6.2</b> 1R: Relative abundance bar chart</a></li>
<li class="chapter" data-level="8.6.3" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#r-difference-from-non-rarefied"><i class="fa fa-check"></i><b>8.6.3</b> 1R: Difference from non-rarefied</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#multiple-rarefaction-mr-iterations"><i class="fa fa-check"></i><b>8.7</b> Multiple Rarefaction (MR) iterations</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#mr-rarefaction"><i class="fa fa-check"></i><b>8.7.1</b> MR: Rarefaction</a></li>
<li class="chapter" data-level="8.7.2" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#mr-difference-from-non-rarefied"><i class="fa fa-check"></i><b>8.7.2</b> MR: Difference from non-rarefied</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#iterating-rarefaction-task"><i class="fa fa-check"></i><b>8.8</b> Iterating rarefaction task</a></li>
<li class="chapter" data-level="8.9" data-path="08-Iterating_rarefaction.html"><a href="08-Iterating_rarefaction.html#iterating-rarefaction-recap"><i class="fa fa-check"></i><b>8.9</b> Iterating rarefaction recap</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html"><i class="fa fa-check"></i><b>9</b> Alpha Diversity</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-setup"><i class="fa fa-check"></i><b>9.1</b> <span class="math inline">\(\alpha\)</span>: Setup</a></li>
<li class="chapter" data-level="9.2" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-iterative-rarefaction-values"><i class="fa fa-check"></i><b>9.2</b> <span class="math inline">\(\alpha\)</span>: Iterative rarefaction values</a></li>
<li class="chapter" data-level="9.3" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-iterative-rarefaction-loop"><i class="fa fa-check"></i><b>9.3</b> <span class="math inline">\(\alpha\)</span>: Iterative rarefaction loop</a></li>
<li class="chapter" data-level="9.4" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-metric-and-metadata-data-frame"><i class="fa fa-check"></i><b>9.4</b> <span class="math inline">\(\alpha\)</span>: Metric and metadata data frame</a></li>
<li class="chapter" data-level="9.5" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha_long_df"><i class="fa fa-check"></i><b>9.5</b> <span class="math inline">\(\alpha\)</span>: Long data frame</a></li>
<li class="chapter" data-level="9.6" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-subset-metrics"><i class="fa fa-check"></i><b>9.6</b> <span class="math inline">\(\alpha\)</span>: Subset metrics</a></li>
<li class="chapter" data-level="9.7" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-violin-plot"><i class="fa fa-check"></i><b>9.7</b> <span class="math inline">\(\alpha\)</span>: Violin plot</a></li>
<li class="chapter" data-level="9.8" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-stats"><i class="fa fa-check"></i><b>9.8</b> <span class="math inline">\(\alpha\)</span>: Stats</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>9.8.1</b> Kruskal Wallis test</a></li>
<li class="chapter" data-level="9.8.2" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#paired-wilcoxon-test"><i class="fa fa-check"></i><b>9.8.2</b> Paired wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-plot-with-stats"><i class="fa fa-check"></i><b>9.9</b> <span class="math inline">\(\alpha\)</span>: Plot with stats</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#list-of-comparisons"><i class="fa fa-check"></i><b>9.9.1</b> List of comparisons</a></li>
<li class="chapter" data-level="9.9.2" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#violin-plot-with-stats"><i class="fa fa-check"></i><b>9.9.2</b> Violin plot with stats</a></li>
<li class="chapter" data-level="9.9.3" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#reorder-x-axis-and-stats"><i class="fa fa-check"></i><b>9.9.3</b> Reorder x-axis and stats</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-task"><i class="fa fa-check"></i><b>9.10</b> <span class="math inline">\(\alpha\)</span>: Task</a></li>
<li class="chapter" data-level="9.11" data-path="09-Alpha_diversity.html"><a href="09-Alpha_diversity.html#alpha-recap"><i class="fa fa-check"></i><b>9.11</b> <span class="math inline">\(\alpha\)</span>: Recap</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Beta_diversity.html"><a href="10-Beta_diversity.html"><i class="fa fa-check"></i><b>10</b> Beta Diversity</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R community advanced analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="alpha_chap" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Alpha Diversity<a href="09-Alpha_diversity.html#alpha_chap" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<center>
<img src="figures/alpha_iterative_rarefaction.png" style="width:300px" />
</center>
<p>In this chapter we'll carry out <strong>alpha diversity</strong> analysis using the <strong>iterative rarefaction</strong> approach.
We will carry this out on the ASV counts rather than at a taxonomy level such as phyla.</p>
<p>These materials are mostly a combination of the <strong>iterative rarefaction</strong> in this book and the <strong>alpha diversity</strong> analysis in the R community workshop.
Due to this we won't go into great detail, instead focussing on giving you the code to be able to carry this out.</p>
<div id="alpha-setup" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> <span class="math inline">\(\alpha\)</span>: Setup<a href="09-Alpha_diversity.html#alpha-setup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<img src="figures/setup_6.png" style="width:200px; background-color:white; border-radius:15px" />
</center>
<p>Create a new R jupyter notebook called "Alpha_diversity.ipynb".</p>
<p>Load the required data and libraries.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb32-1"><a href="09-Alpha_diversity.html#cb32-1" tabindex="-1"></a><span class="co">#Libraries</span></span>
<span id="cb32-2"><a href="09-Alpha_diversity.html#cb32-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;phyloseq&quot;</span>)</span>
<span id="cb32-3"><a href="09-Alpha_diversity.html#cb32-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;microbiome&quot;</span>)</span>
<span id="cb32-4"><a href="09-Alpha_diversity.html#cb32-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb32-5"><a href="09-Alpha_diversity.html#cb32-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;IRdisplay&quot;</span>)</span>
<span id="cb32-6"><a href="09-Alpha_diversity.html#cb32-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggpubr&quot;</span>)</span>
<span id="cb32-7"><a href="09-Alpha_diversity.html#cb32-7" tabindex="-1"></a><span class="co">#Load processed but unrarefied ASV data from main R community workshop</span></span>
<span id="cb32-8"><a href="09-Alpha_diversity.html#cb32-8" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;phyloseq.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="alpha-iterative-rarefaction-values" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> <span class="math inline">\(\alpha\)</span>: Iterative rarefaction values<a href="09-Alpha_diversity.html#alpha-iterative-rarefaction-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<img src="figures/ten_rng_seeds.png" style="width:200px" />
</center>
<p>Before carrying out <strong>iterative rarefaction</strong> we need to decide on a few values</p>
<ul>
<li><strong>Rarefaction size:</strong> The sequence depth to normalise samples to
<ul>
<li>We are using the minimum sample depth here</li>
<li>The size you choose will be based on your data and what you feel is appropriate</li>
<li>More info in the R community workshop</li>
</ul></li>
<li><strong>RNG seeds:</strong> The rng seeds we will use for all the rarefactions
<ul>
<li>We created these in the previous <a href="08-Iterating_rarefaction.html#rng_vec_creation">chapter</a></li>
</ul></li>
<li><strong>Rarefaction iterations:</strong> The number of rarefaction iterations we will use
<ul>
<li>We are using 10 here based on the length of our rng seed vector</li>
<li>We recommend you use 1000 in your real analysis</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb33-1"><a href="09-Alpha_diversity.html#cb33-1" tabindex="-1"></a><span class="co">#Rarefaction values</span></span>
<span id="cb33-2"><a href="09-Alpha_diversity.html#cb33-2" tabindex="-1"></a><span class="co">#Rarefaction size</span></span>
<span id="cb33-3"><a href="09-Alpha_diversity.html#cb33-3" tabindex="-1"></a><span class="co">#Minimum sample depth in this case</span></span>
<span id="cb33-4"><a href="09-Alpha_diversity.html#cb33-4" tabindex="-1"></a>rarefaction_size <span class="ot">&lt;-</span> <span class="fu">min</span>(microbiome<span class="sc">::</span><span class="fu">readcount</span>(pseq))</span>
<span id="cb33-5"><a href="09-Alpha_diversity.html#cb33-5" tabindex="-1"></a><span class="co">#Load the vector of 10 rngseeds created in the previous chapter</span></span>
<span id="cb33-6"><a href="09-Alpha_diversity.html#cb33-6" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;rngseeds.RData&quot;</span>)</span>
<span id="cb33-7"><a href="09-Alpha_diversity.html#cb33-7" tabindex="-1"></a><span class="co">#Number of rarefaction iterations to be carried out</span></span>
<span id="cb33-8"><a href="09-Alpha_diversity.html#cb33-8" tabindex="-1"></a><span class="co">#Based on length of rng seed vector</span></span>
<span id="cb33-9"><a href="09-Alpha_diversity.html#cb33-9" tabindex="-1"></a>rarefaction_iters <span class="ot">&lt;-</span> <span class="fu">length</span>(rngseed_vec)</span></code></pre></div>
</div>
<div id="alpha-iterative-rarefaction-loop" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> <span class="math inline">\(\alpha\)</span>: Iterative rarefaction loop<a href="09-Alpha_diversity.html#alpha-iterative-rarefaction-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<img src="figures/iterative_loops.png" style="width:300px" />
</center>
<p>Now we will create averaged <strong>alpha diversity</strong> values through <strong>iterative rarefaction</strong>.
We will carry this out by:</p>
<ul>
<li>Calculating initial <strong>alpha diversity</strong> values from the first <strong>iteration</strong></li>
<li>Looping through the subsequent <strong>rarefaction iterations</strong> and adding/summing calculated <strong>alpha diversity</strong> values to the initial <strong>alpha diversity</strong> values</li>
<li>Dividing each value of the final summed <strong>alpha diversity</strong> by the number of <strong>rarefaction iterations</strong>.</li>
</ul>
<p>For this we will use the function <code>microbiome::alpha()</code> to calculate our alpha diversity values.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb34-1"><a href="09-Alpha_diversity.html#cb34-1" tabindex="-1"></a><span class="co">#Loop to create iteration based rarefied alpha diversity values</span></span>
<span id="cb34-2"><a href="09-Alpha_diversity.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="09-Alpha_diversity.html#cb34-3" tabindex="-1"></a><span class="co">#Create data frame to contain final summed alpha diversity values</span></span>
<span id="cb34-4"><a href="09-Alpha_diversity.html#cb34-4" tabindex="-1"></a><span class="co">#In this case we&#39;ll run the first rarefied alpha diversity analysis</span></span>
<span id="cb34-5"><a href="09-Alpha_diversity.html#cb34-5" tabindex="-1"></a>pseq_rarefy <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">rarefy_even_depth</span>(pseq,</span>
<span id="cb34-6"><a href="09-Alpha_diversity.html#cb34-6" tabindex="-1"></a>                                           <span class="at">sample.size =</span> rarefaction_size,</span>
<span id="cb34-7"><a href="09-Alpha_diversity.html#cb34-7" tabindex="-1"></a>                                           <span class="at">rngseed =</span> rngseed_vec[<span class="dv">1</span>], <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-8"><a href="09-Alpha_diversity.html#cb34-8" tabindex="-1"></a><span class="co">#Alpha diversity</span></span>
<span id="cb34-9"><a href="09-Alpha_diversity.html#cb34-9" tabindex="-1"></a>alpha_df_sum <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">alpha</span>(pseq_rarefy, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb34-10"><a href="09-Alpha_diversity.html#cb34-10" tabindex="-1"></a></span>
<span id="cb34-11"><a href="09-Alpha_diversity.html#cb34-11" tabindex="-1"></a><span class="co">#Loop through 2 to the number of iterations</span></span>
<span id="cb34-12"><a href="09-Alpha_diversity.html#cb34-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>rarefaction_iters){</span>
<span id="cb34-13"><a href="09-Alpha_diversity.html#cb34-13" tabindex="-1"></a>  pseq_rarefy <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">rarefy_even_depth</span>(pseq,</span>
<span id="cb34-14"><a href="09-Alpha_diversity.html#cb34-14" tabindex="-1"></a>                                           <span class="at">sample.size =</span> rarefaction_size,</span>
<span id="cb34-15"><a href="09-Alpha_diversity.html#cb34-15" tabindex="-1"></a>                                           <span class="at">rngseed =</span> rngseed_vec[i], <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-16"><a href="09-Alpha_diversity.html#cb34-16" tabindex="-1"></a>  <span class="co">#Alpha diversity</span></span>
<span id="cb34-17"><a href="09-Alpha_diversity.html#cb34-17" tabindex="-1"></a>  alpha_df <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">alpha</span>(pseq_rarefy, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb34-18"><a href="09-Alpha_diversity.html#cb34-18" tabindex="-1"></a>  <span class="co">#Add/sum the new data frame values to the sum data frame</span></span>
<span id="cb34-19"><a href="09-Alpha_diversity.html#cb34-19" tabindex="-1"></a>  alpha_df_sum <span class="ot">&lt;-</span> alpha_df_sum <span class="sc">+</span> alpha_df</span>
<span id="cb34-20"><a href="09-Alpha_diversity.html#cb34-20" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="09-Alpha_diversity.html#cb34-21" tabindex="-1"></a><span class="co">#Divide by number of rarefaction iterations to get average</span></span>
<span id="cb34-22"><a href="09-Alpha_diversity.html#cb34-22" tabindex="-1"></a>alpha_df_mean <span class="ot">&lt;-</span> alpha_df_sum <span class="sc">/</span> rarefaction_iters</span>
<span id="cb34-23"><a href="09-Alpha_diversity.html#cb34-23" tabindex="-1"></a><span class="co">#Save alpha mean data frame</span></span>
<span id="cb34-24"><a href="09-Alpha_diversity.html#cb34-24" tabindex="-1"></a><span class="fu">save</span>(alpha_df_mean, <span class="at">file =</span> <span class="st">&quot;alpha_df_mean.RData&quot;</span>)</span>
<span id="cb34-25"><a href="09-Alpha_diversity.html#cb34-25" tabindex="-1"></a><span class="co">#Remove unneeded objects</span></span>
<span id="cb34-26"><a href="09-Alpha_diversity.html#cb34-26" tabindex="-1"></a><span class="fu">rm</span>(pseq,alpha_df_sum, alpha_df)</span></code></pre></div>
<p>You can check the structure and contents of our alpha diversity data frame with <code>head()</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb35-1"><a href="09-Alpha_diversity.html#cb35-1" tabindex="-1"></a><span class="fu">head</span>(alpha_df_mean)</span></code></pre></div>
<p>There are a lot of diversity metrics.
We are only interested in a few of them here but we will remove the other ones later on.</p>
</div>
<div id="alpha-metric-and-metadata-data-frame" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> <span class="math inline">\(\alpha\)</span>: Metric and metadata data frame<a href="09-Alpha_diversity.html#alpha-metric-and-metadata-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have our <strong>alpha diversity</strong> values we will create a data frame that contains these values and metadata.</p>
<p>In the below code we extract the metadata from the rarefied phyloseq object created in the last loop iteration above.
This ensures we only acquire metadata from samples that are retained after <strong>rarefaction</strong>.
The samples that are retained are always the same across our <strong>rarefaction iterations</strong> as samples are retained based on the <strong>rarefaction size/depth</strong> which is kept consistent across our <strong>rarefactions</strong>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb36-1"><a href="09-Alpha_diversity.html#cb36-1" tabindex="-1"></a><span class="co">#Combine metadata and alpha diversity mean values into one data frame</span></span>
<span id="cb36-2"><a href="09-Alpha_diversity.html#cb36-2" tabindex="-1"></a><span class="co">#Extract metadata from rarefied phyloseq object</span></span>
<span id="cb36-3"><a href="09-Alpha_diversity.html#cb36-3" tabindex="-1"></a>metadf <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(pseq)</span>
<span id="cb36-4"><a href="09-Alpha_diversity.html#cb36-4" tabindex="-1"></a><span class="co">#Ensure row names are identical</span></span>
<span id="cb36-5"><a href="09-Alpha_diversity.html#cb36-5" tabindex="-1"></a><span class="co">#if not sort alpha data frame rows by metadata row names</span></span>
<span id="cb36-6"><a href="09-Alpha_diversity.html#cb36-6" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">identical</span>(<span class="fu">row.names</span>(metadf), <span class="fu">row.names</span>(alpha_df_mean)) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb36-7"><a href="09-Alpha_diversity.html#cb36-7" tabindex="-1"></a>  alpha_df_mean <span class="ot">&lt;-</span> alpha_df_mean[<span class="fu">row.names</span>(metadf),]</span>
<span id="cb36-8"><a href="09-Alpha_diversity.html#cb36-8" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="09-Alpha_diversity.html#cb36-9" tabindex="-1"></a><span class="co">#Combine with cbind (column bind)</span></span>
<span id="cb36-10"><a href="09-Alpha_diversity.html#cb36-10" tabindex="-1"></a>meta_alpha_mean_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(metadf,alpha_df_mean)</span>
<span id="cb36-11"><a href="09-Alpha_diversity.html#cb36-11" tabindex="-1"></a><span class="fu">head</span>(meta_alpha_mean_df)</span>
<span id="cb36-12"><a href="09-Alpha_diversity.html#cb36-12" tabindex="-1"></a><span class="co">#Remove rarefied phyloseq object that we do not need any more in this notebook</span></span>
<span id="cb36-13"><a href="09-Alpha_diversity.html#cb36-13" tabindex="-1"></a><span class="fu">rm</span>(pseq_rarefy) </span></code></pre></div>
<p>From the output of <code>head()</code> you should see a table with the first set of columns being the metadata columns. The next set of columns is the alpha diversity metrics.</p>
</div>
<div id="alpha_long_df" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> <span class="math inline">\(\alpha\)</span>: Long data frame<a href="09-Alpha_diversity.html#alpha_long_df" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will plot our <strong>alpha diversity</strong> values with <code>ggplot2</code> functions.
Before we carry this out we need to convert our wide data frame to a long data frame.
We'll carry this out with <code>tidyr::pivot_longer()</code>.</p>
<p>For this we want our metric values to become long.
This means that instead of the <strong>alpha diversity</strong> values being spread across multiple rows and columns their will only be one value per row.</p>
<p>Two columns will represent these values in the long format:</p>
<ul>
<li><strong>metric:</strong> The name of the alpha diversity metric</li>
<li><strong>value:</strong> The value of the alpha diversity metric</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb37-1"><a href="09-Alpha_diversity.html#cb37-1" tabindex="-1"></a><span class="co">#Create long version for plotting</span></span>
<span id="cb37-2"><a href="09-Alpha_diversity.html#cb37-2" tabindex="-1"></a><span class="co">#alpha_df_mean (no metadata) column names to be used for long conversion</span></span>
<span id="cb37-3"><a href="09-Alpha_diversity.html#cb37-3" tabindex="-1"></a>alpha_div_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(alpha_df_mean)</span>
<span id="cb37-4"><a href="09-Alpha_diversity.html#cb37-4" tabindex="-1"></a><span class="co">#Wide to long</span></span>
<span id="cb37-5"><a href="09-Alpha_diversity.html#cb37-5" tabindex="-1"></a>meta_alpha_mean_long_df <span class="ot">&lt;-</span> </span>
<span id="cb37-6"><a href="09-Alpha_diversity.html#cb37-6" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> meta_alpha_mean_df,</span>
<span id="cb37-7"><a href="09-Alpha_diversity.html#cb37-7" tabindex="-1"></a>                      <span class="co">#Change the alpha diversity names to long format</span></span>
<span id="cb37-8"><a href="09-Alpha_diversity.html#cb37-8" tabindex="-1"></a>                      <span class="co">#I.e. keep our metadata columns as separate columns</span></span>
<span id="cb37-9"><a href="09-Alpha_diversity.html#cb37-9" tabindex="-1"></a>                      <span class="co">#all_of() used to silence warning message</span></span>
<span id="cb37-10"><a href="09-Alpha_diversity.html#cb37-10" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="fu">all_of</span>(alpha_div_colnames)</span>
<span id="cb37-11"><a href="09-Alpha_diversity.html#cb37-11" tabindex="-1"></a>                      <span class="co">#Set column name to column called metric</span></span>
<span id="cb37-12"><a href="09-Alpha_diversity.html#cb37-12" tabindex="-1"></a>                      <span class="co">#Set values to column called value</span></span>
<span id="cb37-13"><a href="09-Alpha_diversity.html#cb37-13" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb37-14"><a href="09-Alpha_diversity.html#cb37-14" tabindex="-1"></a>                      )</span>
<span id="cb37-15"><a href="09-Alpha_diversity.html#cb37-15" tabindex="-1"></a><span class="co">#Change our metric column to a factor</span></span>
<span id="cb37-16"><a href="09-Alpha_diversity.html#cb37-16" tabindex="-1"></a><span class="co">#Useful for plotting</span></span>
<span id="cb37-17"><a href="09-Alpha_diversity.html#cb37-17" tabindex="-1"></a>meta_alpha_mean_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(meta_alpha_mean_long_df<span class="sc">$</span>metric)</span>
<span id="cb37-18"><a href="09-Alpha_diversity.html#cb37-18" tabindex="-1"></a><span class="co">#Check head and dimensions of long data frame</span></span>
<span id="cb37-19"><a href="09-Alpha_diversity.html#cb37-19" tabindex="-1"></a><span class="fu">head</span>(meta_alpha_mean_long_df)</span>
<span id="cb37-20"><a href="09-Alpha_diversity.html#cb37-20" tabindex="-1"></a><span class="fu">dim</span>(meta_alpha_mean_long_df)</span>
<span id="cb37-21"><a href="09-Alpha_diversity.html#cb37-21" tabindex="-1"></a><span class="co">#Remove unneeded objects</span></span>
<span id="cb37-22"><a href="09-Alpha_diversity.html#cb37-22" tabindex="-1"></a><span class="fu">rm</span>(alpha_df_mean, metadf)</span></code></pre></div>
</div>
<div id="alpha-subset-metrics" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> <span class="math inline">\(\alpha\)</span>: Subset metrics<a href="09-Alpha_diversity.html#alpha-subset-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are a lot of diversity values created by <code>microbiome::alpha()</code>.
For this tutorial we are only interested in:</p>
<ul>
<li><strong>observed:</strong> The number of observed features (ASVs, Phlya, Species, etc.)</li>
<li><strong>chao1:</strong> The estimated real total number of features</li>
<li><strong>diversity_shannon:</strong> The Shannon diversity metric
<ul>
<li>An estimate of feature diversity based on richness (presence/absence) and abundance</li>
<li>The higher the value the higher the diversity</li>
</ul></li>
</ul>
<p>We'll subset our long data frame to only retain rows with these metrics.
We'll also use the utility of factors to order the metrics so they are plotted in our preferred order further down.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb38-1"><a href="09-Alpha_diversity.html#cb38-1" tabindex="-1"></a><span class="co">#Process our long data frame</span></span>
<span id="cb38-2"><a href="09-Alpha_diversity.html#cb38-2" tabindex="-1"></a><span class="co">#Subset our long alpha diversity data frame to only contain our metrics of choice</span></span>
<span id="cb38-3"><a href="09-Alpha_diversity.html#cb38-3" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;observed&quot;</span>, <span class="st">&quot;chao1&quot;</span>,<span class="st">&quot;diversity_shannon&quot;</span>)</span>
<span id="cb38-4"><a href="09-Alpha_diversity.html#cb38-4" tabindex="-1"></a>basic_alpha_metrics_long_df <span class="ot">&lt;-</span> meta_alpha_mean_long_df[</span>
<span id="cb38-5"><a href="09-Alpha_diversity.html#cb38-5" tabindex="-1"></a>  meta_alpha_mean_long_df<span class="sc">$</span>metric <span class="sc">%in%</span> metrics,</span>
<span id="cb38-6"><a href="09-Alpha_diversity.html#cb38-6" tabindex="-1"></a>]</span>
<span id="cb38-7"><a href="09-Alpha_diversity.html#cb38-7" tabindex="-1"></a><span class="co">#Change instances of diversity_shannon to shannon</span></span>
<span id="cb38-8"><a href="09-Alpha_diversity.html#cb38-8" tabindex="-1"></a>basic_alpha_metrics_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;diversity_shannon&quot;</span>,</span>
<span id="cb38-9"><a href="09-Alpha_diversity.html#cb38-9" tabindex="-1"></a>                                           <span class="at">replacement =</span> <span class="st">&quot;shannon&quot;</span>,</span>
<span id="cb38-10"><a href="09-Alpha_diversity.html#cb38-10" tabindex="-1"></a>                                           <span class="at">x =</span> basic_alpha_metrics_long_df<span class="sc">$</span>metric)</span>
<span id="cb38-11"><a href="09-Alpha_diversity.html#cb38-11" tabindex="-1"></a><span class="co">#The gsub() function changes our factor to a character vector</span></span>
<span id="cb38-12"><a href="09-Alpha_diversity.html#cb38-12" tabindex="-1"></a><span class="co">#Therefore change back to factor</span></span>
<span id="cb38-13"><a href="09-Alpha_diversity.html#cb38-13" tabindex="-1"></a><span class="co">#We will also choose our order of the metric names for plotting</span></span>
<span id="cb38-14"><a href="09-Alpha_diversity.html#cb38-14" tabindex="-1"></a>basic_alpha_metrics_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> basic_alpha_metrics_long_df<span class="sc">$</span>metric,</span>
<span id="cb38-15"><a href="09-Alpha_diversity.html#cb38-15" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;observed&quot;</span>,<span class="st">&quot;chao1&quot;</span>,<span class="st">&quot;shannon&quot;</span>))</span>
<span id="cb38-16"><a href="09-Alpha_diversity.html#cb38-16" tabindex="-1"></a><span class="co">#Check level order of metric factor column</span></span>
<span id="cb38-17"><a href="09-Alpha_diversity.html#cb38-17" tabindex="-1"></a><span class="fu">levels</span>(basic_alpha_metrics_long_df<span class="sc">$</span>metric)</span>
<span id="cb38-18"><a href="09-Alpha_diversity.html#cb38-18" tabindex="-1"></a><span class="co">#Check head of subsetted long data frame</span></span>
<span id="cb38-19"><a href="09-Alpha_diversity.html#cb38-19" tabindex="-1"></a><span class="fu">head</span>(basic_alpha_metrics_long_df)</span></code></pre></div>
<p>With this data frame we can move onto visualisation.</p>
</div>
<div id="alpha-violin-plot" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> <span class="math inline">\(\alpha\)</span>: Violin plot<a href="09-Alpha_diversity.html#alpha-violin-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To visualise the differences of the alpha diversity values between the four different media we'll use violin plots.
We can use the function <code>ggplot2::geom_violin()</code> to carry this out.</p>
<p>Additionally, we'll add a point for each value and colour it based on the site it canme from (UD, MD, or LD).
The function <code>ggforce::geom_sina()</code> can be used for this.
We'll use its parameter <code>alpha()</code> to make the points 50% (<code>0.5</code>) transparent.</p>
<p>As we are plotting values from three different metrics we will split the plot into three separate plots.
<code>ggplot2::facet_wrap()</code> can be used for this tasked with <code>~metric</code> used to split the plot by the metrics.
We also specify <code>scales = "free"</code> so each of the three plots has their own x and y scales.
This is important when the values are drastically different such is the case between the observed and chao1 (&gt;100) compared to the shannon values (&lt;10).</p>
<div class="webex-solution">
<button>
scales options
</button>
<p>The four <code>scales</code> are:</p>
<ul>
<li><strong><code>"fixed"</code> (default):</strong> All the scales are the same (fixed), based on the largest and smallest x and y values across all the plots. Useful where you want direct comparisons such as looking at teh overall pattern in ordination plots.</li>
<li><strong><code>"free"</code>:</strong> All the scales are free. Each plot's x and y values limits are based on the data within it.</li>
<li><strong><code>"free_x"</code>:</strong> The x axis is free and the y axis is fixed.</li>
<li><strong><code>"free_y"</code>:</strong> The y axis is free and the x axis is fixed.</li>
</ul>
<p>Which you wnat to use depends on your data and how you are facetting it.</p>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb39-1"><a href="09-Alpha_diversity.html#cb39-1" tabindex="-1"></a><span class="co">#Produce ggplot object of violin plot</span></span>
<span id="cb39-2"><a href="09-Alpha_diversity.html#cb39-2" tabindex="-1"></a>alpha_violinplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(basic_alpha_metrics_long_df, <span class="fu">aes</span>(<span class="at">x =</span> media, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="09-Alpha_diversity.html#cb39-3" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="09-Alpha_diversity.html#cb39-4" tabindex="-1"></a>                            ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color=</span>site)) <span class="sc">+</span></span>
<span id="cb39-5"><a href="09-Alpha_diversity.html#cb39-5" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Site&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Media&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="09-Alpha_diversity.html#cb39-6" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb39-7"><a href="09-Alpha_diversity.html#cb39-7" tabindex="-1"></a><span class="co">#Save ggplot2 object with ggsave()</span></span>
<span id="cb39-8"><a href="09-Alpha_diversity.html#cb39-8" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot.png&quot;</span>, <span class="at">plot =</span> alpha_violinplot,</span>
<span id="cb39-9"><a href="09-Alpha_diversity.html#cb39-9" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">150</span>, <span class="at">width =</span> <span class="dv">250</span>)</span>
<span id="cb39-10"><a href="09-Alpha_diversity.html#cb39-10" tabindex="-1"></a><span class="co">#Display plot</span></span>
<span id="cb39-11"><a href="09-Alpha_diversity.html#cb39-11" tabindex="-1"></a>IRdisplay<span class="sc">::</span><span class="fu">display_png</span>(<span class="at">file =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot.png&quot;</span>)</span></code></pre></div>
</div>
<div id="alpha-stats" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> <span class="math inline">\(\alpha\)</span>: Stats<a href="09-Alpha_diversity.html#alpha-stats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can carry out statistics to compare the alpha diversity values between sample groups.</p>
<div id="kruskal-wallis-test" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Kruskal Wallis test<a href="09-Alpha_diversity.html#kruskal-wallis-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To determine if there is an overall difference in our data we'll use the Kruskal Wallis test.
We'll carry this out using the media grouping for our three alpha diversity values.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb40-1"><a href="09-Alpha_diversity.html#cb40-1" tabindex="-1"></a><span class="co">#Kruskal Wallis test</span></span>
<span id="cb40-2"><a href="09-Alpha_diversity.html#cb40-2" tabindex="-1"></a><span class="co">#Observed ASVs</span></span>
<span id="cb40-3"><a href="09-Alpha_diversity.html#cb40-3" tabindex="-1"></a><span class="fu">kruskal.test</span>(observed <span class="sc">~</span> media, <span class="at">data =</span> meta_alpha_mean_df)</span>
<span id="cb40-4"><a href="09-Alpha_diversity.html#cb40-4" tabindex="-1"></a><span class="co">#Chao1 estimator</span></span>
<span id="cb40-5"><a href="09-Alpha_diversity.html#cb40-5" tabindex="-1"></a><span class="fu">kruskal.test</span>(chao1 <span class="sc">~</span> media, <span class="at">data =</span> meta_alpha_mean_df)</span>
<span id="cb40-6"><a href="09-Alpha_diversity.html#cb40-6" tabindex="-1"></a><span class="co">#Shannon diversity</span></span>
<span id="cb40-7"><a href="09-Alpha_diversity.html#cb40-7" tabindex="-1"></a><span class="fu">kruskal.test</span>(shannon <span class="sc">~</span> media, <span class="at">data =</span> meta_alpha_mean_df)</span></code></pre></div>
<p>All the p-values are less than 0.05 indicating statistical significance.
That means we can move onto pairwise comparisons.</p>
</div>
<div id="paired-wilcoxon-test" class="section level3 hasAnchor" number="9.8.2">
<h3><span class="header-section-number">9.8.2</span> Paired wilcoxon test<a href="09-Alpha_diversity.html#paired-wilcoxon-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To determine what groups are significantly different from each other we can carry out paired Wilcoxon test.
This tests</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb41-1"><a href="09-Alpha_diversity.html#cb41-1" tabindex="-1"></a><span class="co">#Paired wilcoxon test</span></span>
<span id="cb41-2"><a href="09-Alpha_diversity.html#cb41-2" tabindex="-1"></a><span class="co">#Observed ASVs</span></span>
<span id="cb41-3"><a href="09-Alpha_diversity.html#cb41-3" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(meta_alpha_mean_df<span class="sc">$</span>observed, meta_alpha_mean_df, <span class="at">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span>
<span id="cb41-4"><a href="09-Alpha_diversity.html#cb41-4" tabindex="-1"></a><span class="co">#Chao1 estimator</span></span>
<span id="cb41-5"><a href="09-Alpha_diversity.html#cb41-5" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(meta_alpha_mean_df<span class="sc">$</span>chao1, meta_alpha_mean_df, <span class="at">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span>
<span id="cb41-6"><a href="09-Alpha_diversity.html#cb41-6" tabindex="-1"></a><span class="co">#Shannon diversity</span></span>
<span id="cb41-7"><a href="09-Alpha_diversity.html#cb41-7" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(meta_alpha_mean_df<span class="sc">$</span>shannon, meta_alpha_mean_df, <span class="at">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<p>You'll see three p-value adjusted tables with all the values (except Shannon: ENV against TSA) being significant (&lt;0.05).</p>
</div>
</div>
<div id="alpha-plot-with-stats" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> <span class="math inline">\(\alpha\)</span>: Plot with stats<a href="09-Alpha_diversity.html#alpha-plot-with-stats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rather than having the plot and stats separate, we can add stats onto our plot.
This can be carried out with the function <code>stat_compare_means()</code> from the `<code>ggpubr</code> package.</p>
<div id="list-of-comparisons" class="section level3 hasAnchor" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> List of comparisons<a href="09-Alpha_diversity.html#list-of-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To produce pairwise comparisons with <code>ggpubr::stat_compare_means()</code> we need a <strong>list</strong> of the comparisons we want to carry out.</p>
<p>We can create this with the function <code>combn()</code>, short for combination.
We provide it with three parameters:</p>
<ul>
<li><strong>Input data:</strong> This is a <strong>vector</strong> of the unique metadata categories to create the combinations from
<ul>
<li>We are using our created <code>uniq_media_values_chr_vec</code> in this case</li>
<li>We ensure that this is a <strong>vector</strong> of <strong>characters</strong> so the created combination <strong>list</strong> contains <strong>character vectors</strong></li>
<li>A <strong>list</strong> of <strong>character vectors</strong> is required for <code>ggpubr::stat_compare_means()</code></li>
</ul></li>
<li><strong><code>m =</code>:</strong> The number of elements to choose when creating combinations.
<ul>
<li>We choose <code>2</code> so we get all pair combinations</li>
</ul></li>
<li><strong><code>simplify =</code>:</strong> Indicates if the result should be simple (<code>TRUE</code>) or not (<code>FALSE</code>)
<ul>
<li><code>TRUE</code> returns a simplified array such as a <strong>matrix</strong> or a <strong>data frame</strong></li>
<li><code>FALSE</code> returns a <strong>list</strong>. This is what we want as <code>ggpubr::stat_compare_means()</code> requires a <strong>list</strong></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb42-1"><a href="09-Alpha_diversity.html#cb42-1" tabindex="-1"></a><span class="co">#To compare mean we need to create a list of comparisons</span></span>
<span id="cb42-2"><a href="09-Alpha_diversity.html#cb42-2" tabindex="-1"></a><span class="co">#Create character vector of unique metadata values (media in this case)</span></span>
<span id="cb42-3"><a href="09-Alpha_diversity.html#cb42-3" tabindex="-1"></a>uniq_media_values_chr_vec <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(basic_alpha_metrics_long_df<span class="sc">$</span>media))</span>
<span id="cb42-4"><a href="09-Alpha_diversity.html#cb42-4" tabindex="-1"></a>uniq_media_values_chr_vec</span>
<span id="cb42-5"><a href="09-Alpha_diversity.html#cb42-5" tabindex="-1"></a><span class="co">#Can use combn() to get comparisons</span></span>
<span id="cb42-6"><a href="09-Alpha_diversity.html#cb42-6" tabindex="-1"></a>my_comparisons <span class="ot">&lt;-</span> <span class="fu">combn</span>(uniq_media_values_chr_vec, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>)<span class="er">)</span></span>
<span id="cb42-7"><a href="09-Alpha_diversity.html#cb42-7" tabindex="-1"></a><span class="co">#Check contents and structure</span></span>
<span id="cb42-8"><a href="09-Alpha_diversity.html#cb42-8" tabindex="-1"></a>my_comparisons</span>
<span id="cb42-9"><a href="09-Alpha_diversity.html#cb42-9" tabindex="-1"></a><span class="fu">str</span>(my_comparisons)</span></code></pre></div>
</div>
<div id="violin-plot-with-stats" class="section level3 hasAnchor" number="9.9.2">
<h3><span class="header-section-number">9.9.2</span> Violin plot with stats<a href="09-Alpha_diversity.html#violin-plot-with-stats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With our <strong>list</strong> of comparisons we can add <code>ggpubr::stat_compare_means()</code> to our <code>ggplot2</code> code.
This function will both calculate the Wilcoxon tests and add them to the plot.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb43-1"><a href="09-Alpha_diversity.html#cb43-1" tabindex="-1"></a><span class="co">#Produce ggplot object of violin plot</span></span>
<span id="cb43-2"><a href="09-Alpha_diversity.html#cb43-2" tabindex="-1"></a>alpha_violinplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(basic_alpha_metrics_long_df, <span class="fu">aes</span>(<span class="at">x =</span> media, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="09-Alpha_diversity.html#cb43-3" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb43-4"><a href="09-Alpha_diversity.html#cb43-4" tabindex="-1"></a>                            ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color=</span>site)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="09-Alpha_diversity.html#cb43-5" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Site&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Media&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="09-Alpha_diversity.html#cb43-6" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="09-Alpha_diversity.html#cb43-7" tabindex="-1"></a>                            <span class="co">#Add comparisons</span></span>
<span id="cb43-8"><a href="09-Alpha_diversity.html#cb43-8" tabindex="-1"></a>                            ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> my_comparisons)</span>
<span id="cb43-9"><a href="09-Alpha_diversity.html#cb43-9" tabindex="-1"></a><span class="co">#Save ggplot2 object with ggsave()</span></span>
<span id="cb43-10"><a href="09-Alpha_diversity.html#cb43-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot_pairwise_wilcox.png&quot;</span>, </span>
<span id="cb43-11"><a href="09-Alpha_diversity.html#cb43-11" tabindex="-1"></a>       <span class="at">plot =</span> alpha_violinplot,</span>
<span id="cb43-12"><a href="09-Alpha_diversity.html#cb43-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">150</span>, <span class="at">width =</span> <span class="dv">250</span>)</span>
<span id="cb43-13"><a href="09-Alpha_diversity.html#cb43-13" tabindex="-1"></a><span class="co">#Display plot</span></span>
<span id="cb43-14"><a href="09-Alpha_diversity.html#cb43-14" tabindex="-1"></a>IRdisplay<span class="sc">::</span><span class="fu">display_png</span>(<span class="at">file =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot_pairwise_wilcox.png&quot;</span>)</span></code></pre></div>
</div>
<div id="reorder-x-axis-and-stats" class="section level3 hasAnchor" number="9.9.3">
<h3><span class="header-section-number">9.9.3</span> Reorder x-axis and stats<a href="09-Alpha_diversity.html#reorder-x-axis-and-stats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot</code> orders the x-axis by alphabetical order.
This is not normally wanted so we will convert our media column to a <strong>factor</strong> and order the levels how we want them.
As the environmental samples can be seen as the baseline we will have them first.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb44-1"><a href="09-Alpha_diversity.html#cb44-1" tabindex="-1"></a><span class="co">#Set order of media</span></span>
<span id="cb44-2"><a href="09-Alpha_diversity.html#cb44-2" tabindex="-1"></a>basic_alpha_metrics_long_df<span class="sc">$</span>media <span class="ot">&lt;-</span> <span class="fu">factor</span>(basic_alpha_metrics_long_df<span class="sc">$</span>media,</span>
<span id="cb44-3"><a href="09-Alpha_diversity.html#cb44-3" tabindex="-1"></a>                                            <span class="co">#Set order of levels</span></span>
<span id="cb44-4"><a href="09-Alpha_diversity.html#cb44-4" tabindex="-1"></a>                                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;ENV&quot;</span>, <span class="st">&quot;CVP&quot;</span>, <span class="st">&quot;KBC&quot;</span>, <span class="st">&quot;TSA&quot;</span>))</span></code></pre></div>
<p>The stats in our previous plot were also not in a good order.
We'll therefore reorder them.
When doing this it is important to note that the first comparison in the <strong>lists</strong> is the bottom most stat in the plot.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb45-1"><a href="09-Alpha_diversity.html#cb45-1" tabindex="-1"></a><span class="co">#Order comparisons</span></span>
<span id="cb45-2"><a href="09-Alpha_diversity.html#cb45-2" tabindex="-1"></a>my_ordered_comparisons <span class="ot">&lt;-</span> my_comparisons[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>)]</span>
<span id="cb45-3"><a href="09-Alpha_diversity.html#cb45-3" tabindex="-1"></a>my_ordered_comparisons</span></code></pre></div>
<p>You'll notice this can be quite manual.
It can be made easier when doing this yourself to roughly reorder, run the below code for your plot, then fix the stats reorder.</p>
<p>With our media categories and comparisons reordered we can create the final plot.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb46-1"><a href="09-Alpha_diversity.html#cb46-1" tabindex="-1"></a><span class="co">#Produce ggplot object of violin plot</span></span>
<span id="cb46-2"><a href="09-Alpha_diversity.html#cb46-2" tabindex="-1"></a>alpha_violinplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(basic_alpha_metrics_long_df, <span class="fu">aes</span>(<span class="at">x =</span> media, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="09-Alpha_diversity.html#cb46-3" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="09-Alpha_diversity.html#cb46-4" tabindex="-1"></a>                            ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color=</span>site)) <span class="sc">+</span></span>
<span id="cb46-5"><a href="09-Alpha_diversity.html#cb46-5" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Site&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Media&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="09-Alpha_diversity.html#cb46-6" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="09-Alpha_diversity.html#cb46-7" tabindex="-1"></a>                            <span class="co">#Add comparisons</span></span>
<span id="cb46-8"><a href="09-Alpha_diversity.html#cb46-8" tabindex="-1"></a>                            ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> my_ordered_comparisons)</span>
<span id="cb46-9"><a href="09-Alpha_diversity.html#cb46-9" tabindex="-1"></a><span class="co">#Save ggplot2 object with ggsave()</span></span>
<span id="cb46-10"><a href="09-Alpha_diversity.html#cb46-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot_pairwise_wilcox.png&quot;</span>, </span>
<span id="cb46-11"><a href="09-Alpha_diversity.html#cb46-11" tabindex="-1"></a>       <span class="at">plot =</span> alpha_violinplot,</span>
<span id="cb46-12"><a href="09-Alpha_diversity.html#cb46-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">150</span>, <span class="at">width =</span> <span class="dv">250</span>)</span>
<span id="cb46-13"><a href="09-Alpha_diversity.html#cb46-13" tabindex="-1"></a><span class="co">#Display plot</span></span>
<span id="cb46-14"><a href="09-Alpha_diversity.html#cb46-14" tabindex="-1"></a>IRdisplay<span class="sc">::</span><span class="fu">display_png</span>(<span class="at">file =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_media_violinplot_pairwise_wilcox.png&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="alpha-task" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> <span class="math inline">\(\alpha\)</span>: Task<a href="09-Alpha_diversity.html#alpha-task" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As an optional task if you want more practice create a new violin plot that includes the following:</p>
<ul>
<li>Plots the metrics:
<ul>
<li>"chao1"</li>
<li>"evenness_pielou" renaming it as "pielou"</li>
<li>"diversity_fisher" renaming it as "fisher"</li>
<li>Ensure they are in the order "chao1", "pielou", then "fisher"</li>
</ul></li>
<li>The x-axis is separated by Site (UD, MD, LD) rather than media.
<ul>
<li>Ensure the order is UD, MD, then LD</li>
</ul></li>
<li>Points are coloured by Media (ENV, CVP, KBC, and TSA)
<ul>
<li>Ensure the order is ENV, CVP, KBC, then TSA</li>
</ul></li>
<li>Include Wilcoxon paired stats comparing the Sites</li>
</ul>
<div class="webex-solution">
<button>
Solution code
</button>
<p>Subset <a href="09-Alpha_diversity.html#alpha_long_df">long alpha diversity table created earlier in this chapter</a> to contain metrics of choice.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb47-1"><a href="09-Alpha_diversity.html#cb47-1" tabindex="-1"></a><span class="co">#Process our long data frame</span></span>
<span id="cb47-2"><a href="09-Alpha_diversity.html#cb47-2" tabindex="-1"></a><span class="co">#Subset our long alpha diversity data frame to only contain our metrics of choice</span></span>
<span id="cb47-3"><a href="09-Alpha_diversity.html#cb47-3" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chao1&quot;</span>, <span class="st">&quot;evenness_pielou&quot;</span>,<span class="st">&quot;diversity_fisher&quot;</span>)</span>
<span id="cb47-4"><a href="09-Alpha_diversity.html#cb47-4" tabindex="-1"></a>subset_alpha_metrics_long_df <span class="ot">&lt;-</span> meta_alpha_mean_long_df[</span>
<span id="cb47-5"><a href="09-Alpha_diversity.html#cb47-5" tabindex="-1"></a>  meta_alpha_mean_long_df<span class="sc">$</span>metric <span class="sc">%in%</span> metrics,</span>
<span id="cb47-6"><a href="09-Alpha_diversity.html#cb47-6" tabindex="-1"></a>]</span>
<span id="cb47-7"><a href="09-Alpha_diversity.html#cb47-7" tabindex="-1"></a><span class="co">#Change instances of evenness_pielou to pielou</span></span>
<span id="cb47-8"><a href="09-Alpha_diversity.html#cb47-8" tabindex="-1"></a>subset_alpha_metrics_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;evenness_pieloue&quot;</span>,</span>
<span id="cb47-9"><a href="09-Alpha_diversity.html#cb47-9" tabindex="-1"></a>                                           <span class="at">replacement =</span> <span class="st">&quot;pielou&quot;</span>,</span>
<span id="cb47-10"><a href="09-Alpha_diversity.html#cb47-10" tabindex="-1"></a>                                           <span class="at">x =</span> subset_alpha_metrics_long_df<span class="sc">$</span>metric)</span>
<span id="cb47-11"><a href="09-Alpha_diversity.html#cb47-11" tabindex="-1"></a><span class="co">#Change instances of diversity_fisher to fisher</span></span>
<span id="cb47-12"><a href="09-Alpha_diversity.html#cb47-12" tabindex="-1"></a>subset_alpha_metrics_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;diversity_fisher&quot;</span>,</span>
<span id="cb47-13"><a href="09-Alpha_diversity.html#cb47-13" tabindex="-1"></a>                                           <span class="at">replacement =</span> <span class="st">&quot;fisher&quot;</span>,</span>
<span id="cb47-14"><a href="09-Alpha_diversity.html#cb47-14" tabindex="-1"></a>                                           <span class="at">x =</span> subset_alpha_metrics_long_df<span class="sc">$</span>metric)</span>
<span id="cb47-15"><a href="09-Alpha_diversity.html#cb47-15" tabindex="-1"></a><span class="co">#The gsub() function changes our factor to a character vector</span></span>
<span id="cb47-16"><a href="09-Alpha_diversity.html#cb47-16" tabindex="-1"></a><span class="co">#Therefore change back to factor</span></span>
<span id="cb47-17"><a href="09-Alpha_diversity.html#cb47-17" tabindex="-1"></a><span class="co">#We will also choose our order of the metric names for plotting</span></span>
<span id="cb47-18"><a href="09-Alpha_diversity.html#cb47-18" tabindex="-1"></a>subset_alpha_metrics_long_df<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> subset_alpha_metrics_long_df<span class="sc">$</span>metric,</span>
<span id="cb47-19"><a href="09-Alpha_diversity.html#cb47-19" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;chao1&quot;</span>,<span class="st">&quot;pielou&quot;</span>,<span class="st">&quot;fisher&quot;</span>))</span>
<span id="cb47-20"><a href="09-Alpha_diversity.html#cb47-20" tabindex="-1"></a><span class="co">#Check level order of metric factor column</span></span>
<span id="cb47-21"><a href="09-Alpha_diversity.html#cb47-21" tabindex="-1"></a><span class="fu">levels</span>(subset_alpha_metrics_long_df<span class="sc">$</span>metric)</span>
<span id="cb47-22"><a href="09-Alpha_diversity.html#cb47-22" tabindex="-1"></a><span class="co">#Check head of subsetted long data frame</span></span>
<span id="cb47-23"><a href="09-Alpha_diversity.html#cb47-23" tabindex="-1"></a><span class="fu">head</span>(subset_alpha_metrics_long_df)</span></code></pre></div>
<p>Create metadata combination list for plot stats</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb48-1"><a href="09-Alpha_diversity.html#cb48-1" tabindex="-1"></a><span class="co">#To compare mean we need to create a list of comparisons</span></span>
<span id="cb48-2"><a href="09-Alpha_diversity.html#cb48-2" tabindex="-1"></a><span class="co">#Create character vector of unique metadata values (site in this case)</span></span>
<span id="cb48-3"><a href="09-Alpha_diversity.html#cb48-3" tabindex="-1"></a>uniq_site_values_chr_vec <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(subset_alpha_metrics_long_df<span class="sc">$</span>site))</span>
<span id="cb48-4"><a href="09-Alpha_diversity.html#cb48-4" tabindex="-1"></a>uniq_site_values_chr_vec</span>
<span id="cb48-5"><a href="09-Alpha_diversity.html#cb48-5" tabindex="-1"></a><span class="co">#Can use combn() to get comparisons</span></span>
<span id="cb48-6"><a href="09-Alpha_diversity.html#cb48-6" tabindex="-1"></a>my_comparisons <span class="ot">&lt;-</span> <span class="fu">combn</span>(uniq_site_values_chr_vec, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>)<span class="er">)</span></span>
<span id="cb48-7"><a href="09-Alpha_diversity.html#cb48-7" tabindex="-1"></a><span class="co">#Check contents and structure</span></span>
<span id="cb48-8"><a href="09-Alpha_diversity.html#cb48-8" tabindex="-1"></a>my_comparisons</span>
<span id="cb48-9"><a href="09-Alpha_diversity.html#cb48-9" tabindex="-1"></a><span class="fu">str</span>(my_comparisons)</span></code></pre></div>
<p>Reorder factors and comparisons</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb49-1"><a href="09-Alpha_diversity.html#cb49-1" tabindex="-1"></a><span class="co">#Reorder sites, media and comparisons</span></span>
<span id="cb49-2"><a href="09-Alpha_diversity.html#cb49-2" tabindex="-1"></a><span class="co">#Set order of sites</span></span>
<span id="cb49-3"><a href="09-Alpha_diversity.html#cb49-3" tabindex="-1"></a>subset_alpha_metrics_long_df<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(subset_alpha_metrics_long_df<span class="sc">$</span>site,</span>
<span id="cb49-4"><a href="09-Alpha_diversity.html#cb49-4" tabindex="-1"></a>                                            <span class="co">#Set order of levels</span></span>
<span id="cb49-5"><a href="09-Alpha_diversity.html#cb49-5" tabindex="-1"></a>                                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;UD&quot;</span>, <span class="st">&quot;MD&quot;</span>, <span class="st">&quot;LD&quot;</span>))</span>
<span id="cb49-6"><a href="09-Alpha_diversity.html#cb49-6" tabindex="-1"></a><span class="co">#Set order of media</span></span>
<span id="cb49-7"><a href="09-Alpha_diversity.html#cb49-7" tabindex="-1"></a>subset_alpha_metrics_long_df<span class="sc">$</span>media <span class="ot">&lt;-</span> <span class="fu">factor</span>(subset_alpha_metrics_long_df<span class="sc">$</span>media,</span>
<span id="cb49-8"><a href="09-Alpha_diversity.html#cb49-8" tabindex="-1"></a>                                            <span class="co">#Set order of levels</span></span>
<span id="cb49-9"><a href="09-Alpha_diversity.html#cb49-9" tabindex="-1"></a>                                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;ENV&quot;</span>, <span class="st">&quot;CVP&quot;</span>, <span class="st">&quot;KBC&quot;</span>, <span class="st">&quot;TSA&quot;</span>))</span>
<span id="cb49-10"><a href="09-Alpha_diversity.html#cb49-10" tabindex="-1"></a><span class="co">#Order comparisons</span></span>
<span id="cb49-11"><a href="09-Alpha_diversity.html#cb49-11" tabindex="-1"></a>my_ordered_comparisons <span class="ot">&lt;-</span> my_comparisons[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)]</span>
<span id="cb49-12"><a href="09-Alpha_diversity.html#cb49-12" tabindex="-1"></a>my_ordered_comparisons</span></code></pre></div>
<p>Plot with stats</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb50-1"><a href="09-Alpha_diversity.html#cb50-1" tabindex="-1"></a><span class="co">#Produce ggplot object of violin plot</span></span>
<span id="cb50-2"><a href="09-Alpha_diversity.html#cb50-2" tabindex="-1"></a>alpha_violinplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_alpha_metrics_long_df, <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="09-Alpha_diversity.html#cb50-3" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="09-Alpha_diversity.html#cb50-4" tabindex="-1"></a>                            ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">color=</span>site)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="09-Alpha_diversity.html#cb50-5" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Media&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Site&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="09-Alpha_diversity.html#cb50-6" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="09-Alpha_diversity.html#cb50-7" tabindex="-1"></a>                            <span class="co">#Add comparisons</span></span>
<span id="cb50-8"><a href="09-Alpha_diversity.html#cb50-8" tabindex="-1"></a>                            ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> my_ordered_comparisons)</span>
<span id="cb50-9"><a href="09-Alpha_diversity.html#cb50-9" tabindex="-1"></a><span class="co">#Save ggplot2 object with ggsave()</span></span>
<span id="cb50-10"><a href="09-Alpha_diversity.html#cb50-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_site_violinplot_pairwise_wilcox.png&quot;</span>, </span>
<span id="cb50-11"><a href="09-Alpha_diversity.html#cb50-11" tabindex="-1"></a>       <span class="at">plot =</span> alpha_violinplot,</span>
<span id="cb50-12"><a href="09-Alpha_diversity.html#cb50-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">height =</span> <span class="dv">150</span>, <span class="at">width =</span> <span class="dv">250</span>)</span>
<span id="cb50-13"><a href="09-Alpha_diversity.html#cb50-13" tabindex="-1"></a><span class="co">#Display plot</span></span>
<span id="cb50-14"><a href="09-Alpha_diversity.html#cb50-14" tabindex="-1"></a>IRdisplay<span class="sc">::</span><span class="fu">display_png</span>(<span class="at">file =</span> <span class="st">&quot;./Alpha_diversity_rarefy_iters_site_violinplot_pairwise_wilcox.png&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="alpha-recap" class="section level2 hasAnchor" number="9.11">
<h2><span class="header-section-number">9.11</span> <span class="math inline">\(\alpha\)</span>: Recap<a href="09-Alpha_diversity.html#alpha-recap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MG TO DO: Add info on all alpha diversity metrics in appendix</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="08-Iterating_rarefaction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="10-Beta_diversity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
