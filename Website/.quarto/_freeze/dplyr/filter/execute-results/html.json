{
  "hash": "d90341c48be5d5bb799c94e22907dd5a",
  "result": {
    "markdown": "---\ntitle: \"Filter\"\n---\n\n\n<center>\n![](images/dplyr_filter.png){style=\"width:200px\"}\n</center>\n\nThe `dplyr::filter()` function can be used to extract rows that meet a certain condition.\n\nThis can be a useful method to:\n\n- Filter rows by numerics in a row, e.g. extract rows from years >= 2000.\n- Extract rows belonging to certain groups of metadata.\n\n[Tidyverse reference page](https://dplyr.tidyverse.org//reference/filter.html)\n\n## Dataset\n\nFor demonstration we'll load the `knz_bison` data from the [lterdatasampler package](/datasets/lterdatasampler.qmd) (hyperlink includes install instructions).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Load package\nlibrary(\"lterdatasampler\")\n#knz_bison tibble for demonstration\nbison_tbl <- lterdatasampler::knz_bison |>\n    #Convert to tibble\n    tibble::as_tibble()\nbison_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8,325 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         1994        11       8 813         F                    890\n 2 CBH01         1994        11       8 834         F                   1074\n 3 CBH01         1994        11       8 B-301       F                   1060\n 4 CBH01         1994        11       8 B-402       F                    989\n 5 CBH01         1994        11       8 B-403       F                   1062\n 6 CBH01         1994        11       8 B-502       F                    978\n 7 CBH01         1994        11       8 B-503       F                   1068\n 8 CBH01         1994        11       8 B-504       F                   1024\n 9 CBH01         1994        11       8 B-601       F                    978\n10 CBH01         1994        11       8 B-602       F                   1188\n# ℹ 8,315 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\n## Numeric columns\n\nFilter the __tibble__ to only contain rows/observations from the year 2000 and onwards (>2000).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbison_tbl |> dplyr::filter(rec_year > 2000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6,939 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         2001        11      14 A1          F                    824\n 2 CBH01         2001        11      14 A11         F                   1030\n 3 CBH01         2001        11      14 A12         F                    984\n 4 CBH01         2001        11      14 A13         F                    986\n 5 CBH01         2001        11      14 A14         F                    978\n 6 CBH01         2001        11      14 A15         F                   1052\n 7 CBH01         2001        11      14 A16         F                   1010\n 8 CBH01         2001        11      14 A17         F                    992\n 9 CBH01         2001        11      14 A18         F                    960\n10 CBH01         2001        11      14 A19         F                    960\n# ℹ 6,929 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\n## String columns\n\nFilter the __tibble__ to only contain male observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbison_tbl |> dplyr::filter(animal_sex == \"M\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,040 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         1994        11       8 910         M                    982\n 2 CBH01         1994        11       8 91C         M                   1020\n 3 CBH01         1994        11       8 91F         M                   1050\n 4 CBH01         1994        11       8 91H         M                   1037\n 5 CBH01         1994        11       8 91J         M                   1104\n 6 CBH01         1994        11       8 91K         M                   1306\n 7 CBH01         1994        11       8 91L         M                   1122\n 8 CBH01         1994        11       8 91M         M                   1136\n 9 CBH01         1994        11       8 91P         M                    996\n10 CBH01         1994        11       8 91W         M                    954\n# ℹ 3,030 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\n## Multiple columns\n\nYou can filter based on multiple columns with logical operators.\n\nThe 2 main R logical operators are:\n\n- `&`: and (ampersand symbol)\n- `|`: or (pipe symbol)\n\nExtract females that have a weight greater or equal to 1000 pounds.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbison_tbl |> dplyr::filter(animal_sex == \"F\" & animal_weight >= 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,215 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         1994        11       8 834         F                   1074\n 2 CBH01         1994        11       8 B-301       F                   1060\n 3 CBH01         1994        11       8 B-403       F                   1062\n 4 CBH01         1994        11       8 B-503       F                   1068\n 5 CBH01         1994        11       8 B-504       F                   1024\n 6 CBH01         1994        11       8 B-602       F                   1188\n 7 CBH01         1994        11       8 B-701       F                   1030\n 8 CBH01         1994        11       8 B-704       F                   1030\n 9 CBH01         1994        11       8 B-706       F                   1108\n10 CBH01         1994        11       8 884         F                   1046\n# ℹ 1,205 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\nExtract males or samples with a weight less than 900 pounds.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbison_tbl |> dplyr::filter(animal_sex == \"M\" | animal_weight < 900)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5,982 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         1994        11       8 813         F                    890\n 2 CBH01         1994        11       8 B-905       F                    828\n 3 CBH01         1994        11       8 B-909       F                    812\n 4 CBH01         1994        11       8 W-008       F                    884\n 5 CBH01         1994        11       8 910         M                    982\n 6 CBH01         1994        11       8 91C         M                   1020\n 7 CBH01         1994        11       8 91F         M                   1050\n 8 CBH01         1994        11       8 91H         M                   1037\n 9 CBH01         1994        11       8 91J         M                   1104\n10 CBH01         1994        11       8 91K         M                   1306\n# ℹ 5,972 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\n## Pipes\n\nYou can use pipes for finer control of multiple comparisons.\n\nThe below command carries out the following filtering steps in order:\n\n1. Extract females. \n2. Extract observations with animal weight between 900 and 1100. \n3. Extract samples from the year 2000.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbison_tbl |> \n    #Filter to retain females\n    dplyr::filter(animal_sex == \"F\") |>\n    #Filter to retain samples with animal_weight between 900 and 1100\n    dplyr::filter(animal_weight > 900 & animal_weight < 1000) |>\n    #Retain samples from year 2000\n    dplyr::filter(rec_year == 2000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 39 × 8\n   data_code rec_year rec_month rec_day animal_code animal_sex animal_weight\n   <chr>        <dbl>     <dbl>   <dbl> <chr>       <chr>              <dbl>\n 1 CBH01         2000        11      16 A11         F                    976\n 2 CBH01         2000        11      16 A14         F                    930\n 3 CBH01         2000        11      16 A16         F                    952\n 4 CBH01         2000        11      16 A17         F                    964\n 5 CBH01         2000        11      16 A18         F                    904\n 6 CBH01         2000        11      16 A2          F                    910\n 7 CBH01         2000        11      16 A22         F                    992\n 8 CBH01         2000        11      16 A27         F                    970\n 9 CBH01         2000        11      16 A28         F                    902\n10 CBH01         2000        11      16 A6          F                    992\n# ℹ 29 more rows\n# ℹ 1 more variable: animal_yob <dbl>\n```\n:::\n:::\n\n\n## NA removal\n\nFor removal of NAs please see the [tidyr drop NA page](/tidyr/drop_na.qmd).",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}